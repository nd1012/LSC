const i18n_defaultLocale="en",i18n_messages={};var i18n_locale=null,i18n_localeUri=null,i18n_localeInfo=!1;const i18n_translate=(a,b,c)=>{if("array"==typeof a){const c=[];b=!!b;for(const d of a)c.push(i18n_translate(d,b));return c}var d,e,f,g,h;const i=(chrome||msBrowser||browser)?.i18n||null,j="data-i18nhtml",k="",l="undefined",m="innerText",n="innerHTML",o=a=>"Missing translation \""+a+"\"",p=i?["Title","Alt","Value"]:null,q="string"==typeof a,r=q&&b||!q&&c,s=q?a:null,t=q?null:{},u=a=>i?i.getMessage(a):null==i18n_locale||typeof i18n_messages[i18n_locale]==l||typeof i18n_messages[i18n_locale][a]==l?k:i18n_messages[i18n_locale][a],v=c=>{e=c.hasAttribute(j),f=c.getAttribute("data-i18ninfo"),g=u(d=c.getAttribute(e?j:"data-i18ntext")),g!=k&&b||(t[d]={message:c[e?n:m],description:f,html:e,attr:null,missing:g==k}),g==k||a||(c[e?n:m]=g),r&&g==k&&console.warn(o(d),c);for(const e of p)c.hasAttribute(e)&&(g=u(h=d+e),g!=k&&b||(t[h]={message:c.getAttribute(e),description:null==f?null:f+" ("+e+")",html:!1,attr:e.toLowerCase(),missing:g==k}),g==k||a||c.setAttribute(e,g),r&&g==k&&console.warn(o(h),c))};if(!i)return q?"":t;if(q){const a=u(s);return r&&a==k&&(console.warn(o(s)),console.trace()),a}if(a instanceof HTMLElement){const d=a;return a=!1,c=!!b,b=!1,v(d),t}for(const d of document.querySelectorAll("*[data-i18ntext],*[data-i18nhtml]"))v(d);return t},i18n_determineLocale=async()=>{if(null!=i18n_locale)return i18n_locale;const a=(chrome||msBrowser||browser)?.i18n||null;var b=a?(await a.getAcceptLanguages())[0]:navigator.language;return 2<b.length&&0>b.indexOf("_")&&(b=b.substring(0,2)+"_"+b.substring(3)),b},i18n_loadMessages=async(a,b)=>{if(("undefined"==typeof a||null==a)&&(a=await i18n_determineLocale()),2<a.length&&0>a.indexOf("_")&&(a=a.substring(0,2)+"_"+a.substring(3)),"undefined"!=typeof i18n_messages[a])return!i18n_messages[a]&&b?await i18n_loadMessages(i18n_defaultLocale):i18n_messages[a];const c=null==i18n_localeUri?"/_locales":i18n_localeUri;if(i18n_localeInfo&&("array"!=typeof i18n_localeInfo&&(i18n_localeInfo=await(await fetch(c+"/locales.json")).json()),i18n_localeInfo&&"undefined"==typeof i18n_localeInfo[a])){if(!(2<a.length))return await i18n_loadMessages(i18n_defaultLocale);if(a=a.substring(0,2),typeof i18n_localeInfo[a]=="undefined")return await i18n_loadMessages(i18n_defaultLocale)}var d=await(await fetch(c+"/"+a+"/messages.json")).json();return!d&&2<a.lenght&&(a=a.substring(0,2),d=await(await fetch(c+"/"+a+"/messages.json")).json()),d||a!=i18n_defaultLocale||(i18n_messages[i18n_defaultLocale]=d=i18n_translate(!0)),b&&!d?await i18n_loadMessages(i18n_defaultLocale):i18n_messages[a]=d?d:null},i18n_setLocale=async(a,b)=>{2<a.length&&0>a.indexOf("_")&&(a=a.substring(0,2)+"_"+a.substring(3)),i18n_locale=a;const c=(chrome||msBrowser||browser)?.i18n||null,d=document.querySelector("html"),e=d?i18n_locale.substring(0,2):null;d&&d.getAttribute("lang")!=e&&d.setAttribute("lang",e);const f=c?null:await i18n_loadMessages(null,!0);return i18n_translate(!1,!1,!!b),f},i18n_init=async(a,b,c)=>(b&&!i18n_localeInfo&&(i18n_localeInfo=!0),"undefined"!=typeof a&&(i18n_localeUri=a),await i18n_setLocale(await i18n_determineLocale(),!!c),i18n_locale);