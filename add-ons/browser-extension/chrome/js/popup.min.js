window.addEventListener("load",async()=>{const a=Array.from(document.querySelectorAll("input:not([type=\"button\"])")).flatMap(a=>a.id),b=document.getElementById("website"),c=document.getElementById("nowebsite");statusElement=document.getElementById("status"),rxHttp=/^https?\:\/\//,manageTab=async d=>{const e=rxHttp.test(d.url.toLowerCase()),f=e?{type:"manage",options:await api.storage.sync.get(defaultSettings)}:null;if(e){for(let b of a)f[b]=document.getElementById(b).checked;b.removeAttribute("hidden"),c.setAttribute("hidden","hidden"),api.tabs.sendMessage(d.id,f)}else b.setAttribute("hidden","hidden"),c.removeAttribute("hidden")},updateStatus=async()=>{const a=(await api.tabs.query({active:!0,currentWindow:!0}))[0],b=a&&rxHttp.test(a.url.toLowerCase());if(!b)return statusElement.innerText="inactive",statusElement.className="inactive",void setTimeout(updateStatus,500);try{await api.tabs.sendMessage(a.id,{type:"status"},a=>{statusElement.innerText=a,statusElement.className=a,setTimeout(updateStatus,500)})}catch(a){console.error("Failed to request LSC plugin status",a),statusElement.innerText="inactive",statusElement.className="inactive"}},document.getElementById("session").checked=await api.storage.sync.get({session:defaultSettings.session}).session,await manageTab((await api.tabs.query({active:!0,currentWindow:!0}))[0]);for(let b of a)document.getElementById(b).addEventListener("change",async()=>await manageTab((await api.tabs.query({active:!0,currentWindow:!0}))[0]));document.getElementById("close").addEventListener("click",()=>close()),await updateStatus()});